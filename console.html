<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="manfred friscic's location on the world wide web">

    <title>friscic.com</title>

    <style>
        * {
            font-family: monospace;
            font-size: 1.4rem;
            font-weight: bold;
            color: #41FF00;
            background-color: black;
            border-color: black;
            text-transform: uppercase;
            margin: 0.2rem;
            /* pointer-events: none; */
        }

        h1,
        h2,
        h3,
        h4 {
            width: fit-content;
        }

        #cursor {
            width: 1rem;
            height: 2rem;
            animation: blinker 1s linear infinite;
            background-color: #41FF00;
        }

        .highlight {
            background-color: #41FF00;
            color: black;
            padding: 0 0.4rem 0 0.2rem;
            margin: 0.4rem;
        }

        @keyframes blinker {
            50% {
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <h1><i>https://</i>friscic.com</h1>
    <h2><a href="#"><span class="highlight">1</span></a>about</h2>
    <h3><a href="#"><span class="highlight">2</span></a>contact</h3>
    <h4><a href="#"><span class="highlight">3</span></a>imprint</h4>
    <div id="lines">
        ~$<input id="input" value="" style="width: 0ch" /><input id="cursor" />
    </div>

    <script>
        const lines = document.getElementById("lines");
        
        const input = document.getElementById("input");

        // TODO input field not clickable

        const cursor = document.getElementById("cursor");

        document.addEventListener('keyup', (e) => {
            checkKeyInput(e);
            cursor.value = ''; // hack input.value
            e.preventDefault();
        });

        document.addEventListener('input', (e) => {
            checkInput(e);
            // e.preventDefault();
        });

        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const pageNr = Number(urlParams.get('p'));
        /*
        * check query params for page nr.
        */
        if (!isNaN(pageNr)) {
            checkStringInput(pageNr);
        }

        function newLine(text, highlight = false) {

            const className = 'line' + highlight ?? ' highlight';

            const options = {
                html: '',
                href: '#',
            };

            let line = document.createElement("div");
            line.innerHTML = text;
            line.className = 'line';
            if (highlight) {
                line.className += ' highlight';
            }
            lines.prepend(line);
        }

        function newLink(url, text) {
            let link = document.createElement("a");
            link.innerHTML = text;
            link.href = url;
            newLine(link);
        }

        createHtml = (tag, options) => {
            let e = document.createElement(tag);
            e.innerHTML = options.html || '';
            e.href = options.href || '#';

            return e;
        }

        checkInput = (i) => {
            if (!i.data) {
                return;
            }

            checkStringInput();
        }

        checkKeyInput = (e) => {

            /*
               0 - 47 ignore
               48 - 90 output
               < 124 error
            */

            // keyCode: 189

            // if (e.keyCode > 96 && e.keyCode <= 123) {
            //     return;
            // }

            if (e.keyCode > 48 && e.keyCode <= 123) {
                input.value += e.key;
            }

            switch (e.keyCode) {
                /* space */
                case 32: {
                    input.value += ' ';
                    break;
                }
                /* backspace */
                case 8: {
                    input.value = input.value.substr(0, input.value.length - 1);
                    break;
                }
                /* enter */
                case 13: {
                    checkStringInput();

                    newLine(input.value || '*');

                    input.value = '';
                    break;
                }
                default:
                    if (e.keyCode < 48 && e.keyCode > 90) {
                        newLine(`'${input.value || e.key}' is not recognized as a command, operable program or batch file`);
                        return; // todo
                    }
                    break;
            }

            input.setAttribute('style', `width: ${input.value.length}ch`);
        }

        function checkStringInput(inputString = input.value) {
            switch (inputString.toString()) {
                case '1':
                    newLine('about', true);
                    newLink('https://www.xing.com/profile/Manfred_Friscic', 'xing');
                    newLink('https://www.linkedin.com/in/friscic/', 'linkedin');
                    newLine('&nbsp;');
                    break;
                case '2':
                    newLine('contact', true);
                    newLink('mailto:manfred@friscic.com', 'email');
                    newLine('&nbsp;');
                    break;
                case '3':
                    newLine('impressum', true);
                    newLine('mag. manfred friscic');
                    newLine('neustiftgasse 54');
                    newLine('1070 wien');
                    newLine('manfred@friscic.com');
                    newLine('&nbsp;');
                    break;
                case 'clear':
                case 'cls':
                    lines.innerHTML = '';
                    break;
                default:
                    break;
            }
        }
    </script>
</body>

</html>