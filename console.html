<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="manfred friscic's location on the world wide web">

    <title>friscic.com</title>

    <style>
        * {
            font-family: monospace;
            font-size: 1.5rem;
            font-weight: bold;
            color: #41FF00;
            background-color: black;
            border-color: black;
            text-transform: uppercase;
            text-decoration: none;
            margin: 0.2rem;
            width: fit-content;
        }

        h1,
        h2,
        h3,
        h4 {
            width: fit-content;
        }

        #cursor {
            width: 1.5rem;
            height: 2rem;
            animation: blinker 1s linear infinite;
            background-color: #41FF00;
        }

        .highlight {
            background-color: #41FF00;
            color: black;
            padding: 0 0.4rem 0 0.2rem;
            margin: 0.4rem;
        }

        @keyframes blinker {
            50% {
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <h1><a href="/">friscic.comツ】</a></h1>
    <h2><a href="?p=1"><span class="highlight">1</span>about</a></h2>
    <h3><a href="?p=2"><span class="highlight">2</span>contact</a></h3>
    <h4><a href="?p=3"><span class="highlight">3</span>imprint</a></h4>
    <div id="lines"></div>
    ~$<span id="input"></span><input id="cursor" />

    <script>
        const lines = document.getElementById("lines");

        const input = document.getElementById("input");

        // TODO input field not clickable

        const cursor = document.getElementById("cursor");

        document.addEventListener('keyup', (e) => {
            checkKeyInput(e);
            cursor.value = ''; // hack input.value
        });

        document.addEventListener('input', (e) => {
            checkInput(e);
            cursor.value = ''; // hack input.value
        });

        // check url query params for page nr.
        const urlParams = new URLSearchParams(window.location.search);
        const pageNr = Number(urlParams.get('p'));
        if (!isNaN(pageNr)) {
            checkStringInput(pageNr);
        }

        function newLine(text, highlight = false) {

            const className = 'line' + highlight ?? ' highlight';

            const options = {
                html: '',
                href: '#',
            };

            let line = document.createElement("div");
            line.innerHTML = text;
            line.className = 'line';
            if (highlight) {
                line.className += ' highlight';
            }
            lines.append(line);
        }

        function newLink(url, text) {
            let link = document.createElement("a");
            link.innerHTML = text;
            link.href = url;
            link.target = '_blank';
            lines.append(link);
        }

        createHtml = (tag, options) => {
            let e = document.createElement(tag);
            e.innerHTML = options.html || '';
            e.href = options.href || '#';

            return e;
        }

        checkInput = (i) => {
            if (!i.data) {
                return;
            }

            input.innerHTML += i.data;

            checkStringInput(i.data);
        }

        checkKeyInput = (e) => {

            /*
               0 - 47 ignore
               48 - 90 output
               < 124 error
            */

            // keyCode: 189

            // if (e.keyCode > 96 && e.keyCode <= 123) {
            //     return;
            // }

            if (e.keyCode > 48 && e.keyCode <= 123) {
                input.innerHTML += e.key;
            }

            switch (e.keyCode) {
                /* space */
                case 32: {
                    input.innerHTML += ' ';
                    break;
                }
                /* backspace */
                case 8: {
                    let clean = input.innerHTML.replaceAll('&nbsp;', ' ');
                    input.innerHTML = clean.substr(0, clean.length - 1).replaceAll(' ', '&nbsp;');
                    break;
                }
                /* enter */
                case 13: {
                    checkStringInput();

                    newLine(input.innerHTML || '*');

                    input.innerHTML = '';
                    break;
                }
                default:
                    if (e.keyCode < 48 && e.keyCode > 90) {
                        newLine(`'${input.innerHTML || e.key}' is not recognized as a command, operable program or batch file`);
                        return; // todo
                    }
                    break;
            }

            // input.setAttribute('style', `width: ${input.value.length}ch`);
        }

        function checkStringInput(inputString = input.innerHTML) {
            switch (inputString.toString()) {
                case '1':
                    newLine('about', true);
                    newLink('https://www.xing.com/profile/Manfred_Friscic', 'xing');
                    newLink('https://www.linkedin.com/in/friscic/', 'linkedin');
                    break;
                case '2':
                    newLine('contact', true);
                    newLink('mailto:manfred@friscic.com', 'manfred@friscic.com');
                    break;
                case '3':
                    newLine('impressum', true);
                    newLine('mag. manfred friscic');
                    newLine('neustiftgasse 54');
                    newLine('1070 wien');
                    newLine('manfred@friscic.com');
                    break;
                case 'clear':
                case 'cls':
                    lines.innerHTML = '';
                    break;
                default:
                    break;
            }
        }
    </script>
</body>

</html>